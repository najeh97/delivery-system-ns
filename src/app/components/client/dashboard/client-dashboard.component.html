<div class="container mx-auto p-4">
  <div class="mb-6 flex items-center justify-between">
    <h1 class="text-2xl font-bold">Client Dashboard</h1>
  </div>

  <!-- Profile Summary -->
  <div *ngIf="client" class="mb-6 overflow-hidden rounded-lg border bg-white shadow-sm">
    <div class="border-b bg-gray-50 px-4 py-3 text-lg font-medium">Your Profile</div>
    <div class="p-4">
      <div class="mb-1"><span class="font-medium">Name:</span> {{ client.name }}</div>
      <div class="mb-1"><span class="font-medium">Email:</span> {{ client.email }}</div>
      <div class="mb-1">
        <span class="font-medium">Status:</span>
        <span
          [ngClass]="{
            'text-yellow-600': client.approvalStatus === 'pending',
            'text-green-600': client.approvalStatus === 'approved',
            'text-red-600': client.approvalStatus === 'rejected',
          }"
          class="font-medium"
        >
          {{ client.approvalStatus | titlecase }}
        </span>
      </div>

      <div *ngIf="client.approvalStatus === 'pending'" class="mt-3 rounded-md bg-yellow-50 p-3 text-sm text-yellow-800">
        Your account is pending approval. Some features may be limited until an admin approves your account.
      </div>

      <div *ngIf="client.approvalStatus === 'rejected'" class="mt-3 rounded-md bg-red-50 p-3 text-sm text-red-800">
        Your account has been rejected. Please contact the administrator for more information.
      </div>

      <div class="mt-3">
        <a routerLink="/client/profile" class="text-blue-600 hover:underline"> View and Edit Profile </a>
      </div>
    </div>
  </div>

  <!-- Quick Actions -->
  <div class="mb-6">
    <h2 class="mb-3 text-xl font-semibold">Quick Actions</h2>
    <div class="grid grid-cols-1 gap-3 sm:grid-cols-2 md:grid-cols-4">
      <a
        routerLink="/client/requests/new"
        class="rounded-lg bg-white p-4 text-center shadow-sm transition hover:bg-gray-50"
        [class.opacity-50]="client?.approvalStatus !== 'approved'"
        [class.pointer-events-none]="client?.approvalStatus !== 'approved'"
      >
        <div class="mb-2 flex justify-center">
          <span class="flex h-10 w-10 items-center justify-center rounded-full bg-green-100 text-green-600">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="h-6 w-6"
            >
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
            </svg>
          </span>
        </div>
        <h3 class="font-medium">Create New Request</h3>
        <p class="mt-1 text-xs text-gray-500">Create a new delivery request</p>
      </a>

      <a
        routerLink="/client/requests"
        class="rounded-lg bg-white p-4 text-center shadow-sm transition hover:bg-gray-50"
      >
        <div class="mb-2 flex justify-center">
          <span class="flex h-10 w-10 items-center justify-center rounded-full bg-blue-100 text-blue-600">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="h-6 w-6"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M8.25 7.5V6.108c0-1.135.845-2.098 1.976-2.192.373-.03.748-.057 1.123-.08M15.75 18H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08M15.75 18.75v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5A3.375 3.375 0 006.375 7.5H5.25m11.9-3.664A2.251 2.251 0 0015 2.25h-1.5a2.251 2.251 0 00-2.15 1.586m5.8 0c.065.21.1.433.1.664v.75h-6V4.5c0-.231.035-.454.1-.664M6.75 7.5H4.875c-.621 0-1.125.504-1.125 1.125v12c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V16.5a9 9 0 00-9-9z"
              />
            </svg>
          </span>
        </div>
        <h3 class="font-medium">View Requests</h3>
        <p class="mt-1 text-xs text-gray-500">Manage your delivery requests</p>
      </a>

      <a routerLink="/client/drivers" class="rounded-lg bg-white p-4 text-center shadow-sm transition hover:bg-gray-50">
        <div class="mb-2 flex justify-center">
          <span class="flex h-10 w-10 items-center justify-center rounded-full bg-purple-100 text-purple-600">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="h-6 w-6"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M8.25 18.75a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 01-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m3 0h1.125c.621 0 1.129-.504 1.09-1.124a17.902 17.902 0 00-3.213-9.193 2.056 2.056 0 00-1.58-.86H14.25M16.5 18.75h-2.25m0-11.177v-.958c0-.568-.422-1.048-.987-1.106a48.554 48.554 0 00-10.026 0 1.106 1.106 0 00-.987 1.106v7.635m12-6.677v6.677m0 4.5v-4.5m0 0h-12"
              />
            </svg>
          </span>
        </div>
        <h3 class="font-medium">View Drivers</h3>
        <p class="mt-1 text-xs text-gray-500">Check available drivers</p>
      </a>

      <a
        routerLink="/client/payments"
        class="rounded-lg bg-white p-4 text-center shadow-sm transition hover:bg-gray-50"
      >
        <div class="mb-2 flex justify-center">
          <span class="flex h-10 w-10 items-center justify-center rounded-full bg-yellow-100 text-yellow-600">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="h-6 w-6"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M2.25 18.75a60.07 60.07 0 0115.797 2.101c.727.198 1.453-.342 1.453-1.096V18.75M3.75 4.5v.75A.75.75 0 013 6h-.75m0 0v-.375c0-.621.504-1.125 1.125-1.125H20.25M2.25 6v9m18-10.5v.75c0 .414.336.75.75.75h.75m-1.5-1.5h.375c.621 0 1.125.504 1.125 1.125v9.75c0 .621-.504 1.125-1.125 1.125h-.375m1.5-1.5H21a.75.75 0 00-.75.75v.75m0 0H3.75m0 0h-.375a1.125 1.125 0 01-1.125-1.125V15m1.5 1.5v-.75A.75.75 0 003 15h-.75M15 10.5a3 3 0 11-6 0 3 3 0 016 0zm3 0h.008v.008H18V10.5zm-12 0h.008v.008H6V10.5z"
              />
            </svg>
          </span>
        </div>
        <h3 class="font-medium">Payments</h3>
        <p class="mt-1 text-xs text-gray-500">View payment status</p>
      </a>
    </div>
  </div>

  <!-- Recent Requests -->
  <div class="mb-6">
    <h2 class="mb-3 text-xl font-semibold">Recent Delivery Requests</h2>
    <div class="overflow-x-auto rounded-lg border bg-white shadow-sm">
      <table class="w-full table-auto">
        <thead>
          <tr class="bg-gray-50">
            <th class="border-b px-4 py-2 text-left text-sm font-medium text-gray-500">ID</th>
            <th class="border-b px-4 py-2 text-left text-sm font-medium text-gray-500">Date</th>
            <th class="border-b px-4 py-2 text-left text-sm font-medium text-gray-500">Status</th>
            <th class="border-b px-4 py-2 text-left text-sm font-medium text-gray-500">Payment</th>
            <th class="border-b px-4 py-2 text-left text-sm font-medium text-gray-500">Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngIf="recentRequests.length === 0">
            <td colspan="5" class="px-4 py-3 text-center text-sm text-gray-500">No delivery requests found.</td>
          </tr>
          <tr *ngFor="let request of recentRequests">
            <td class="border-b px-4 py-2">{{ request.id.substring(0, 8) }}</td>
            <td class="border-b px-4 py-2">{{ formatDate(request.date) }}</td>
            <td class="border-b px-4 py-2">
              <span
                [ngClass]="{
                  'bg-yellow-100 text-yellow-800': request.deliveryStatus === 'pending',
                  'bg-blue-100 text-blue-800': request.deliveryStatus === 'assigned',
                  'bg-purple-100 text-purple-800': request.deliveryStatus === 'in-progress',
                  'bg-green-100 text-green-800': request.deliveryStatus === 'completed',
                  'bg-red-100 text-red-800': request.deliveryStatus === 'cancelled',
                }"
                class="inline-block rounded-full px-2 py-1 text-xs font-semibold"
              >
                {{ request.deliveryStatus | titlecase }}
              </span>
            </td>
            <td class="border-b px-4 py-2">
              <span
                [ngClass]="{
                  'bg-yellow-100 text-yellow-800': request.paymentStatus === 'pending',
                  'bg-green-100 text-green-800': request.paymentStatus === 'paid',
                  'bg-red-100 text-red-800': request.paymentStatus === 'cancelled',
                }"
                class="inline-block rounded-full px-2 py-1 text-xs font-semibold"
              >
                {{ request.paymentStatus | titlecase }}
              </span>
            </td>
            <td class="border-b px-4 py-2">
              <a [routerLink]="['/client/requests', request.id]" class="text-blue-600 hover:underline">View Details</a>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <div *ngIf="recentRequests.length > 0" class="mt-2 text-right">
      <a routerLink="/client/requests" class="text-blue-600 hover:underline">View All Requests</a>
    </div>
  </div>

  <!-- Stats Summary -->
  <div class="grid grid-cols-1 gap-4 sm:grid-cols-2 md:grid-cols-3">
    <div class="rounded-lg border bg-white p-4 shadow-sm">
      <h2 class="text-sm font-medium text-gray-500">Total Requests</h2>
      <p class="mt-2 text-3xl font-semibold">{{ requests.length }}</p>
    </div>

    <div class="rounded-lg border bg-white p-4 shadow-sm">
      <h2 class="text-sm font-medium text-gray-500">Active Requests</h2>
      <p class="mt-2 text-3xl font-semibold">{{ activeRequests.length }}</p>
    </div>

    <div class="rounded-lg border bg-white p-4 shadow-sm">
      <h2 class="text-sm font-medium text-gray-500">Completed Requests</h2>
      <p class="mt-2 text-3xl font-semibold">{{ completedRequests.length }}</p>
    </div>
  </div>
</div>
